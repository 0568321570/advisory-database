{
  "schema_version": "1.2.0",
  "id": "GHSA-9qrh-qjmc-5w2p",
  "modified": "2022-04-28T20:25:23Z",
  "published": "2022-04-28T20:25:23Z",
  "aliases": [
    "CVE-2022-21227"
  ],
  "summary": "Denial-of-Service due to fatal error when binding invalid parameters",
  "details": "### Impact\n\nAffected versions will experience a fatal error when supplying a specific object in the parameter array. This error causes the application to crash and could not be caught.\n\nUsers of `sqlite3` v5.0.0, v5.0.1 and v5.0.2 are affected by this.\n\n### Patches\n\nFixed in v5.0.3. All users are recommended to upgrade to v5.0.3 or later.\n\n### Workarounds\n\n* Ensure there is sufficient sanitization in the parent application to protect against invalid values being supplied to binding parameters.\n\n### References\n\n* GitHub commit: https://github.com/TryGhost/node-sqlite3/commit/593c9d498be2510d286349134537e3bf89401c4a\n* Reported via issues: https://github.com/TryGhost/node-sqlite3/issues/1440 and https://github.com/TryGhost/node-sqlite3/issues/1449\n* Snyk: https://security.snyk.io/vuln/SNYK-JS-SQLITE3-2388645\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n\n* Email us at [security@ghost.org](mailto:security@ghost.org)\n",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "sqlite3"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "5.0.0"
            },
            {
              "fixed": "5.0.3"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/TryGhost/node-sqlite3/security/advisories/GHSA-9qrh-qjmc-5w2p"
    },
    {
      "type": "WEB",
      "url": "https://github.com/TryGhost/node-sqlite3/issues/1440"
    },
    {
      "type": "WEB",
      "url": "https://github.com/TryGhost/node-sqlite3/issues/1449"
    },
    {
      "type": "WEB",
      "url": "https://github.com/TryGhost/node-sqlite3/commit/593c9d498be2510d286349134537e3bf89401c4a"
    },
    {
      "type": "WEB",
      "url": "https://security.snyk.io/vuln/SNYK-JS-SQLITE3-2388645"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/TryGhost/node-sqlite3"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-248"
    ],
    "severity": "HIGH",
    "github_reviewed": true
  }
}