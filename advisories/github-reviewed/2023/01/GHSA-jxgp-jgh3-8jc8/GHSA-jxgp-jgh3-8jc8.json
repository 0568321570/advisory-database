{
  "schema_version": "1.3.0",
  "id": "GHSA-jxgp-jgh3-8jc8",
  "modified": "2023-01-09T21:57:54Z",
  "published": "2023-01-09T21:57:54Z",
  "aliases": [
    "CVE-2023-22480"
  ],
  "summary": "KubeOperator allows unauthorized access to system API",
  "details": "### Summary\nAPI interfaces with unauthorized access will leak sensitive information\n/api/v1/clusters/kubeconfig/<clusterName>\n### Details\nRoutes using v1 without any restrictions\n<img width=\"930\" alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211258033-84aa14fb-01d5-459c-af81-e48b7552fabf.png\">\n\nDirectly pass in `downloadKubeconfig` according to the cluster name\n\n<img width=\"960\" alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211258011-d885fda6-06c3-4603-be4a-38d9c9b918b4.png\">\npkg/router/v1/white.go\n\nno restrictions\n```go\nfunc downloadKubeconfig(ctx context.Context) {\n\tclusterName := ctx.Params().GetString(\"name\")\n\tctx.Header(\"Content-Disposition\", \"attachment\")\n\tctx.Header(\"filename\", fmt.Sprintf(\"%s-config\", clusterName))\n\tctx.Header(\"Content-Type\", \"application/download\")\n\tclusterService := service.NewClusterService()\n\tstr, err := clusterService.GetKubeconfig(clusterName)\n\tif err != nil {\n\t\t_, _ = ctx.JSON(err)\n\t\tctx.StatusCode(http.StatusInternalServerError)\n\t}\n\t_, _ = ctx.WriteString(str)\n}\n```\n<img width=\"872\" alt=\"image\" src=\"https://user-images.githubusercontent.com/35884266/211258106-79204452-b0b8-4d02-b774-1c2b61dd6bf2.png\">\n\n### Impact\nThis is an unauthorized access to the kubeconfig vulnerability, which can be used to take over the cluster under certain conditions",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/KubeOperator/KubeOperator"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "3.16.3"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/KubeOperator/KubeOperator/security/advisories/GHSA-jxgp-jgh3-8jc8"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/KubeOperator/KubeOperator"
    }
  ],
  "database_specific": {
    "cwe_ids": [

    ],
    "severity": "HIGH",
    "github_reviewed": true
  }
}